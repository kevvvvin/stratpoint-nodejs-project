version: '3.8'

services:
  user-service:
    build:
      context: ./services/user-service
      dockerfile: Dockerfile
    volumes:
      - ./services/user-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/user-service/.env
    ports:
      - "3001:3001"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  account-service:
    build:
      context: ./services/account-service
      dockerfile: Dockerfile
    volumes:
      - ./services/account-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/account-service/.env
    ports:
      - "3002:3002"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  transaction-service:
    build:
      context: ./services/transaction-service
      dockerfile: Dockerfile
    volumes:
      - ./services/transaction-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/transaction-service/.env
    ports:
      - "3003:3003"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  payment-service:
    build:
      context: ./services/payment-service
      dockerfile: Dockerfile
    volumes:
      - ./services/payment-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/payment-service/.env
    ports:
      - "3004:3004"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  kyc-service:
    build:
      context: ./services/kyc-service
      dockerfile: Dockerfile
    volumes:
      - ./services/kyc-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/kyc-service/.env
    ports:
      - "3005:3005"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  notification-service:
    build:
      context: ./services/notification-service
      dockerfile: Dockerfile
    volumes:
      - ./services/notification-service:/usr/src/app  # Volume mount
    env_file:
      - ./services/notification-service/.env
    ports:
      - "3006:3006"
    depends_on:
      - mongodb
    networks:
      - mynetwork

  mongodb:
    image: mongo:latest
    ports:
      - "27017:27017"
    volumes:
      - mongo-data:/data/db
    networks:
      - mynetwork

  mailhog:
    image: mailhog/mailhog:latest
    ports:
      - "1025:1025"
      - "8025:8025"
    networks:
      - mynetwork

networks:
 mynetwork:

volumes:
 mongo-data: